# 립 시뮬레이션 GUI 중간 산출물 가이드

본 문서는 립 렌더링 엔진의 튜닝 GUI에서 표시되는 주요 중간 단계 데이터(Maps)의 역할과 의미를 기술합니다. 각 단계의 데이터를 이해하면 파라미터 튜닝 시 더욱 정밀한 결과물을 얻을 수 있습니다.

---

## 1. Mask / Geometry (마스크 및 기하 구조)
입술의 영역을 정의하고 수치화된 좌표계를 구축하는 단계입니다.

*   **`lip01` (Soft Mask)**:
    - **역할**: 입술의 전체 영역을 나타내는 0~1 사이의 마스크입니다.
    - **특징**: 경계선 부분에 페더링(Feathering)이 적용되어 있어, 컬러나 하이라이트가 원본 피부와 자연스럽게 섞이도록 돕습니다.
*   **`x_hat` (Horizontal Coordinate)**:
    - **역할**: 입술의 좌측 끝(-1)부터 우측 끝(1)까지를 나타내는 정규화된 가로 좌표입니다.
    - **특징**: 입술 중심선을 0으로 하여 대칭적인 효과를 조절할 때 사용됩니다.
*   **`y_hat` (Vertical Coordinate)**:
    - **역할**: 입술 중앙선을 0으로, 윗입술 끝을 -1, 아랫입술 끝을 1로 정의하는 세로 좌표입니다.
    - **특징**: 윗입술과 아랫입술을 논리적으로 구분하고 각 영역의 깊이감을 조절하는 기준이 됩니다.
*   **`r` (Distance from Center)**:
    - **역할**: 입술 중앙선으로부터의 거리를 나타냅니다 (`abs(y_hat)`).
    - **특징**: 중앙에서 경계선으로 갈수록 값이 커지며, 주로 경계면의 하이라이트 감쇄(Falloff)를 계산할 때 사용됩니다.

---

## 2. Fake Normal (법선 벡터 추정)
2D 이미지에서 입술의 3차원 입체감을 인위적으로 생성하는 단계입니다.

*   **`normal_Nx / Ny / Nz`**:
    - **역할**: 각 픽셀에서의 표면 기울기(법선 벡터)를 X, Y, Z 축 별로 시각화한 것입니다.
    - **의미**: `Nx`는 좌우 경사, `Ny`는 상하 경사, `Nz`는 정면을 향하는 정도를 나타냅니다. 이 벡터들이 광원 방향과 연산되어 하이라이트의 위치를 결정합니다.
*   **`normal_length`**:
    - **역할**: 계산된 법선 벡터의 크기(정규화 상태 확인용)를 나타냅니다.
    - **특징**: 모든 입술 영역에서 균일하게 밝게 보여야 정상적인 법선 벡터가 생성된 것입니다.

---

## 3. Specular & Clear Coat (광택 및 코팅 효과)
설정된 광원과 기하 구조를 바탕으로 실제 반사광을 생성하는 단계입니다.

*   **`spec` (Specular Map)**:
    - **역할**: 퐁 반사 모델(Phong Reflection)을 통해 계산된 기본적인 직접 반사광 영역입니다.
    - **특징**: `LIGHT_DIR`과 `SHININESS` 파라미터에 따라 하이라이트의 위치와 날카로움이 결정됩니다.
*   **`hwf / clear_weight` (Highlight Weight Function)**:
    - **역할**: 입술 표면에 코팅막(Clear Coat)이 형성될 특정 위치를 지정하는 가중치 맵입니다.
    - **특징**: `UPPER_CENTER`, `LOWER_CENTER` 등의 파라미터를 통해 하이라이트가 맺힐 '가장 예쁜 위치'를 강제로 지정할 수 있게 해줍니다.
*   **`clear_spec` (Clear Coat Specular)**:
    - **역할**: `clear_weight` 영역 내에서 발생한 2차 반사광 효과입니다.
    - **특징**: 일반 Specular보다 더 투명하고 매끄러운 막이 씌워진 듯한 느낌을 주며, 실제 립글로스를 바른 듯한 광택의 완성도를 높입니다.

---

## 4. 최종 결과물
*   **`original_roi` / `final_roi`**: 입술 영역을 확대한 전/후 비교입니다.
*   **`final`**: 모든 레이어(컬러 + 스펙큘러 + 클리어코트)가 원본 이미지에 최종적으로 합성된 결과입니다.
